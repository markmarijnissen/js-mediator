!function(){function r(r){return r.map(function(r){return o[r]})}var n={},o={},t=[],e=[];n.register=function(n,a){if("string"!=typeof n)throw new Error("Name must be a string!");if("object"!=typeof a)throw new Error("Must register an object!");var i=n[0]===n[0].toLowerCase();if(i)o[n]||(o[n]=[]),o[n].push(a);else{if(o[n])throw new Error("Module "+n+" already exists!");o[n]=a;for(var u=t.length-1;u>=0;u--){var l=t[u],c=l.waitFor.indexOf(n);if(c>-1&&(l.waitFor.splice(c,1),0===l.waitFor.length)){var f=r(l.modules);l.callback.apply(null,f),t.splice(u,1)}}}return e.forEach(function(r){r(a,n)}),a},n.couple=function(e,a){var i=e.filter(function(r){return!o[r]});return 0===i.length?a.apply(null,r(e)):t.push({waitFor:i,modules:e,callback:a}),n},n.forEach=function(r,t,a){if(Array.isArray(r)&&"function"==typeof t&&(a=t,t=r,r=null),"function"==typeof r&&(a=r,t=[],r=null),"function"==typeof t&&(a=t,t=[]),"function"!=typeof a)throw new Error("Callback is not a function!");return n.couple(t,function(n){n=Array.prototype.slice.apply(arguments);var t=function(o,t){(r===!1||r===t)&&a.apply(null,[o,t].concat(n))};e.push(t),Object.keys(o).forEach(function(r){var n=o[r];Array.isArray(n)?n.forEach(function(n){t(n,r)}):t(n,r)})}),n},window.Mediator=n,module&&module.exports&&(module.exports=n)}();